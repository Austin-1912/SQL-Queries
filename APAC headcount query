substr(activity_code,3,1) as channel,
 
SUM(Case when Channel = 'P' THEN (TOTAL_EMAILS_SENT) ELSE 1 END) as communications_sent,

count(case when EMAILS_UN_DELIVERED > 0 then 1 end) as Communications_undelivered,
 
count(case when EMAILS_OPENED_ATLEAST_ONCE_WITHIN_7_DAYS_OF_COMMUNICATION > 0 then 1 end) as communications_OPENED_ATLEAST_ONCE_WITHIN_7_DAYS_OF_COMMUNICATION,

count(case when EMAILS_WITH_ATLEAST_ONE_LINK_CLICK_WITHIN_7_DAYS_OF_COMMUNICATION > 0  then 1 end) as communications_WITH_ATLEAST_ONE_LINK_CLICK_WITHIN_7_DAYS_OF_COMMUNICATION,
 
