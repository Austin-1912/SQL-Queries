CREATE OR REPLACE TABLE CAR_806_TXN_BASE AS
    SELECT
    DATE_TRUNC('MONTH', txn.rcvpaying_datetime) AS MTH_YR,
    txn.rcvpaying_datetime                      AS txn_dt,
    txn.SNDCOUNTRY_CODE AS snd_country,
    txn.RCVCOUNTRY_CODE AS rcv_country,
    -- CONCAT(txn.SNDCOUNTRY_CODE, '-', txn.RCVCOUNTRY_CODE) AS corridor,
    txn.SNDCUSTOMER_KEY AS GID,
    txn.MTCN,
    CASE
        WHEN TXN.PRICING_CHANNEL IN ('WEB', 'APP') THEN 'DIGITAL'
        WHEN TXN.PRICING_CHANNEL IN ('POS', 'TMT', 'AIR') THEN 'RETAIL'
        ELSE 'OTHER'
    END AS channel_group,
    txn.SNDPRINCIPAL_USD,
    txn.Revenue,
    txn.PAYOUT_TYPE
FROM WUDNA.SUMMARY_GEN.WUDNA_TXN_MASTER_ANALYTICS_VW txn
    JOIN WUDNA.SUMMARY_GEN.WUDNA_CUSTOMER_MASTER_VW cm
        ON txn.sndcustomer_key = cm.customer_key
WHERE txn.rcvpaying_datetime >= '2024-10-01'
  AND txn.rcvpaying_datetime <= '2025-12-31'
  AND txn.SNDCOUNTRY_CODE IN ('AE')
  AND txn.RCVCOUNTRY_CODE IN ('LB');
