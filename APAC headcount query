CREATE OR REPLACE TABLE CAM_1746_BASE1 AS 
SELECT 
    txn.SNDCUSTOMER_KEY,
    txn.TXN_ID,
    DATE_TRUNC('MONTH', txn.rcvpaying_datetime) AS mth_yr,
    txn.sndcountry_code,
    txn.rcvcountry_code,
    txn.PAYOUT_TYPE,
    cm.age
FROM WUDNA.SUMMARY_GEN.WUDNA_TXN_MASTER_ANALYTICS_VW txn
    LEFT JOIN wudna.summary_gen.wudna_customer_master_vw cm
        ON txn.sndcustomer_key = cm.customer_key
WHERE SNDCOUNTRY_CODE = 'US'
    AND DATE(rcvpaying_datetime) >= '2025-02-01'
    AND DATE(rcvpaying_datetime) < '2026-02-01'
    AND sndcustomer_key IS NOT NULL;

SELECT 
    MTH_YR,
    SNDCUSTOMER_KEY,
    COUNTRY_CODE,
    FLAG_MARKETABLE,
    R12_TXNS,
    R12_PRINCIPAL,
    R12_REVENUE,
    RFM__PERSONA,
    DOMINANT_CHANNEL,
    DOMINANT__CORRIDOR,
    DOMINANT_CORRIDOR_TYPE_1,
    DOMINANT__SNDCOUNTRY_NAME,
    RETAIL_DIGITAL__FLAG,
    MYWU_STATUS_1,
    Dominant_attribute_funds_in
FROM Country_Packet_CUST_LEVEL_R12
