Hi Austin/Naveen,

As discussed, Please add 'USER_ID' in the amplitude dataset which required to get Customer-UMN, once added, join the account summary on USER_ID = MD5(CUSTOMER_UMN) to get UMN/GID mapping against the Amplitude-ID.

Please find the code logic below: 
1.	Replicate below code with your amplitude source table to add USER_ID in your dataset.

    create or replace table SP_AMPLITUDE_NC_FUNNEL_CNTRY_EVENT_T9 as
    select
        a.*,
        b.user_id 
    from
        SP_AMPLITUDE_NC_FUNNEL_CNTRY_EVENT_T8 A
    LEFT JOIN
        (select  amplitude_id, Max(user_id) as user_id from             SP_AMPLITUDE_RAW_DATA_NOV_DEC_2025 group by 1) B
ON
    A.amplitude_id=b.amplitude_id;


2.	Here in the below code, we have joined the account summary on USER_ID = MD5(CUSTOMER_UMN) to get UMN/GID mapping against the Amplitude-ID.

    create or replace table SP_AMPLITUDE_NC_FUNNEL_CNTRY_EVENT_T10 as
    select
        a.*,
        b.customer_key as GID, 
        b.customer_umn,
   
    from
        SP_AMPLITUDE_NC_FUNNEL_CNTRY_EVENT_T9 A
    LEFT JOIN
        WUDNA.SUMMARY_GEN.WUDNA_ACCOUNT_MASTER_VW B
    ON
        A.USER_ID=MD5(B.CUSTOMER_UMN);
