-- 5. Total customers (union), senders, receivers
SELECT
    COUNT(DISTINCT SNDCUSTOMER_KEY) AS total_senders,
    COUNT(DISTINCT RCVCUSTOMER_KEY) AS total_receivers,
    COUNT(DISTINCT customer_key)    AS total_customers
FROM (
    SELECT SNDCUSTOMER_KEY AS customer_key
    FROM SUMMARY_GEN.WUDNA_TXN_MASTER_ANALYTICS_VW t
    WHERE DATE(RCVPAYING_DATETIME) BETWEEN '2024-10-01' AND '2025-09-30'
    UNION
    SELECT RCVCUSTOMER_KEY
    FROM SUMMARY_GEN.WUDNA_TXN_MASTER_ANALYTICS_VW tn
    WHERE DATE(RCVPAYING_DATETIME) BETWEEN '2024-10-01' AND '2025-09-30'
);
