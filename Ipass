SELECT
    (SELECT COUNT(DISTINCT c.customer_key)
     FROM SUMMARY_GEN.WUDNA_CUSTOMER_MASTER_VW c
     JOIN SUMMARY_GEN.COUNTRY_VW cnt
       ON c.country_code = cnt.country_code
     WHERE cnt.super_region = 'LACA'
       AND DATE_TRUNC('MONTH', c.first_registration_date)
             BETWEEN DATEADD(MONTH, -11, TO_DATE('2025-08-01'))
                 AND TO_DATE('2025-08-31')) AS registered_count,
 
    (SELECT COUNT(DISTINCT t.sndcustomer_key)
     FROM SUMMARY_GEN.WUDNA_TXN_MASTER_ANALYTICS_VW t
     JOIN SUMMARY_GEN.COUNTRY_VW snd
       ON t.sndcountry_code = snd.country_code
     WHERE snd.super_region = 'LACA'
       AND DATE_TRUNC('MONTH', t.rcvpaying_datetime)
             BETWEEN DATEADD(MONTH, -11, TO_DATE('2025-08-01'))
                 AND TO_DATE('2025-08-31')) AS transacted_count,
 
    (SELECT COUNT(DISTINCT customer_key)
     FROM LACA_RNT_CUSTOMERS
     WHERE ref_date = TO_DATE('2025-08-01')) AS rnt_count,

     
 -- Difference between registered and transacted
    (
      (SELECT COUNT(DISTINCT c.customer_key)
       FROM SUMMARY_GEN.WUDNA_CUSTOMER_MASTER_VW c
       JOIN SUMMARY_GEN.COUNTRY_VW cnt
         ON c.country_code = cnt.country_code
       WHERE cnt.super_region = 'LACA'
         AND DATE_TRUNC('MONTH', c.first_registration_date)
               BETWEEN DATEADD(MONTH, -11, TO_DATE('2025-08-01'))
                   AND TO_DATE('2025-08-31'))
      -
      (SELECT COUNT(DISTINCT t.sndcustomer_key)
       FROM SUMMARY_GEN.WUDNA_TXN_MASTER_ANALYTICS_VW t
       JOIN SUMMARY_GEN.COUNTRY_VW snd
         ON t.sndcountry_code = snd.country_code
       WHERE snd.super_region = 'LACA'
         AND DATE_TRUNC('MONTH', t.rcvpaying_datetime)
               BETWEEN DATEADD(MONTH, -11, TO_DATE('2025-08-01'))
                   AND TO_DATE('2025-08-31'))
    ) AS reg_minus_txn_count;
