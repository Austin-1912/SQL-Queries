WITH base_txn AS (
    SELECT DISTINCT
        t.SNDCUSTOMER_KEY   -- 19-digit GID
    FROM SUMMARY_GEN.WUDNA_TXN_MASTER_ANALYTICS_VW t
    WHERE UPPER(t.SNDCOUNTRY_CODE) IN ('AU', 'NZ')
      AND UPPER(t.RCVCOUNTRY_CODE) IN ('IN', 'FJ', 'NP', 'MY', 'SG')
      AND DATE(RCVPAYING_DATETIME) BETWEEN '2024-09-01' AND '2025-08-31'
)
SELECT DISTINCT
    b.SNDCUSTOMER_KEY AS gid_customer_key,
    cm.customer_umn    AS umn_customer_key
FROM base_txn b
JOIN SUMMARY_GEN.CUSTOMER_MASTER_VW cm
  ON b.SNDCUSTOMER_KEY = cm.customer_key;
