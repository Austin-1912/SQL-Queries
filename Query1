How to Use These Validation Queries:
Run Them In This Order:
Validation 1-3: Check individual table structures
Validation 4: Check final segmentation table
Validation 5: Verify decomposition hierarchy
Validation 6: Compare with Power BI YOY numbers
Validation 7: Data quality checks
What to Look For:
Validation 1-2: RNT & Engagement Tables
Row counts should be consistent across months
Flags (r12_active, lapsed_r12_plus) should be mutually exclusive where appropriate
Validation 3: Aggregation
Total customers should be the sum of all segments
Transaction counts should be preserved
Validation 4: Final Segmentation
Each audience_segment should account for all customer types
No customers should be missing or duplicated
Validation 5: Hierarchy
Active R1-R12 + Churn R7-R12 should sum to total active
Lapsed breakdown should only appear for Lapsed R12+
Validation 6: YOY Comparison
Compare these numbers directly with your Power BI cards:
Aug 2025 vs Aug 2024
YOY change and YOY %
Validation 7: Data Quality
NULL checks ensure data completeness
Duplicate checks ensure no overlaps
Expected Results Format:
Your Power BI cards should show (approximately):
Aug 2025:
- Total Customers: 11.5M
- Transacted: 7.2M
- RNT: 3.2M
- Active R1-R12: 7.2M

YOY vs Aug 2024:
- Total: ↑ 1.2M (+11.7%)
- Transacted: ↑ 850K (+13.3%)
- RNT: ↓ 200K (-5.9%)
- Active: ↑ 950K (+15.2%)
Run these and share the results. If any numbers don't match, we can identify where the mismatch is occurring!
