i have a script:
CREATE OR REPLACE TABLE AM_BIRD_campaign_wise_sms_communications_TEST AS
WITH AK_BIRD_CAMPAIGN_WISE_SMS_COMMUNICATIONS as (

SELECT 
A.customer_key,
NVL(B.ACTIVITY_CODE,'SASAA') ACTIVITY_CODE,
	upper(A.NAME) campaign_desc,
    upper(a.NAME) as campaign_desc_1,
	//date_trunc('DAY', A.ACTIONDATETIME) as release_2_vendor_date,
    A.ACTIONDATETIME as release_2_vendor_date,
	country AS country,
    b.EVENT_CAPTURED_DAY,
    b.PREV_EVENT_CAPTURED_DT,
    A.DAYS_BETWEEN_COMMUNICATION,
    SENT,
    DELIVERED,
    UNDELIVERED,
    ACTIONDATETIME,
    NAME,
FROM 
    //--WUDNA.SUMMARY_GEN.BIRD_WU_MARKETING_SMS_SENT_VW A
    AK_BIRD_WU_MARKETING_SMS_SENT_BASE A
LEFT JOIN 
    (select 
    a.*,

    from AK_BIRD_SOLICITATION_HISTORY_VW a 

    where substr(activity_code,3,1) = 'S'
    ) b

ON 
a.customer_key = b.customer_key AND 
date_trunc('DAY', date(A.ACTIONDATETIME)) = date_trunc('DAY', b.release_2_vendor_date) AND 
trim(upper(a.NAME)) = upper(b.campaign_desc)

),


SMS_Undelivered_main as (
    SELECT 
        DISTINCT customer_key AS customer_id ,
        name as campaign_desc
    
    FROM 
    (
    SELECT
        customer_key,
        NAME,
    FROM 
        //--WUDNA.SUMMARY_GEN.BIRD_WU_MARKETING_SMS_SENT_VW B
        AK_BIRD_WU_MARKETING_SMS_SENT_BASE B
    WHERE 
        customer_key IS NOT NULL 
        AND DELIVERED < 1
    )
    
    //-- WHERE
    //--     DELIVERED < 1
),


LS_sfmc_CEM_SMS_CAMPAIGN_v4 as

(
select 
    distinct A.*,
    //date_trunc('DAY',CLICK_TIMESTAMP) as event_captured_day,
    CLICK_TIMESTAMP as event_captured_day,

from 
    (
    SELECT 
    CASE  
    
        WHEN A.customer_key IS NULL OR A.customer_key ='' then B.cuid
        ELSE A.customer_key
            END AS customer_key,
    
        LAST_ATTRIBUTED_TOUCH_DATA_CUSTOM_FIELDS,
        BRANCH_REFERRER,
        LOG_TITLE,
        LOG_DESCRIPTION,
        DOMAIN,
        URL,
        WEB_ONLY,
        DESKTOP_URL,
        FALLBACK_URL,
        CANONICAL_URL,
        ANDROID_URL,
        IOS_URL,
        CUID,--customer key
        UTM_CAMPAIGN,
        UTM_MEDIUM,
        UTM_SOURCE,
        CREATION_SOURCE,
        CLICK_TIMESTAMP_RAW,
        CLICK_TIMESTAMP,--click date
        CAN--campaign name
    
    
    FROM 
        "WUDNA"."SUMMARY_GEN"."WU_MARKETING_SMS_CLICK_VW" B
    LEFT JOIN 
        "WUDNA"."SUMMARY_GEN".WUDNA_ACCOUNT_MASTER_VW A ON B.CUID  = A.CUSTOMER_UMN
    
    WHERE  
        B.CUID IS NOT NULL 
        //AND UPPER(URL) NOT LIKE '%UNSUB%'
        //AND (URL IS NULL OR UPPER(URL) NOT LIKE '%UNSUB%')


    )a


where 
    a.customer_key is not null 
    and year(CLICK_TIMESTAMP) >= 2024

),


AK_BIRD_MARKETING_SMS_OPT_OUT_VW as
(
select 
    * 
from 
    (
    select 
        distinct a.customer_key,
        upper(campaign_desc) campaign_name,
        release_2_vendor_Date,
        WEB_TIMESTAMP ,
        row_number() over (partition by a.customer_key order by release_2_vendor_Date desc) rnk //
    from 
        AK_BIRD_CAMPAIGN_WISE_SMS_COMMUNICATIONS a
    inner join 

    (
        SELECT 
  

            customer_key,
            MOBILE_COUNTRY_CODE,
            WEB_TIMESTAMP ,
            SMS_TIMEZONE,
            SMS_FLAG
        FROM 
            summary_gen.BIRD_WU_MARKETING_SMS_OPT_OUT_VW B
        WHERE  
            B.customer_key IS NOT NULL
    )b on a.customer_key = b.customer_key and a.release_2_vendor_Date <= b.WEB_TIMESTAMP 
)
where rnk = 1
),

LS_sfmc_SMS_OPT_OUT as
(
select distinct a.*,
date_trunc('DAY',TO_DATE(WEB_TIMESTAMP)) as event_captured_day,


from  
(
SELECT 

customer_key,

CAMPAIGN_NAME,

CAST(WEB_TIMESTAMP AS DATE) AS WEB_TIMESTAMP,
from  AK_BIRD_MARKETING_SMS_OPT_OUT_VW B

WHERE  B.customer_key IS NOT NULL 
)a,


where A.customer_key is not null and year(WEB_TIMESTAMP) >= 2024
),

campaign_wise_sms_communications_main as 
(
select 
 a.customer_key,
 a.country,
 a.release_2_vendor_date,
 a.activity_code,
 a.campaign_desc,
 upper(a.campaign_desc) as campaign_desc_1,
 prev_event_captured_dt,
 days_between_communication,
 case when b.customer_id is not null then 'UNDELIVERED' else 'DELIVERED' end  delivery_flag,
 case when upper(nvl(a.CAMPAIGN_desc,'UNKNOWN'))  like '%RESEND%' or 
		upper(nvl(a.CAMPAIGN_desc,'UNKNOWN'))  like '%RE SEND%' or 
		upper(nvl(a.CAMPAIGN_desc,'UNKNOWN'))  like '%RE_SEND%' or 
		upper(nvl(a.CAMPAIGN_desc,'UNKNOWN'))  like '%RE-SEND%'
		then 'Y' else 'N' end as RESEND_FLAG,
case when d.EVENT_CAPTURED_DAY is not null and d.EVENT_CAPTURED_DAY >= a.release_2_vendor_date 
		then 'Y' else 'N' end click_flag,
case when  
d.EVENT_CAPTURED_DAY >= a.release_2_vendor_date then d.EVENT_CAPTURED_DAY end as click_date,
case when
d.EVENT_CAPTURED_DAY >= a.release_2_vendor_date then d.url end offer_url,
g.event_captured_day as optout_date,
case when delivery_flag = 'DELIVERED' and click_flag='Y' and   d.EVENT_CAPTURED_DAY >= a.release_2_vendor_date
and (extract(epoch from d.EVENT_CAPTURED_DAY)-extract(epoch from a.release_2_vendor_date)) <= 2592000 then 'Y' else 'N' end as  sms_clicked_in_30_Days,
case when delivery_flag = 'DELIVERED' and click_flag='Y' and   d.EVENT_CAPTURED_DAY >= a.release_2_vendor_date
and (extract(epoch from d.EVENT_CAPTURED_DAY)-extract(epoch from a.release_2_vendor_date)) <= 604800 then 'Y' else 'N' end as  sms_clicked_in_7_Days 
from AK_BIRD_CAMPAIGN_WISE_SMS_COMMUNICATIONS a 
left outer join LS_sfmc_CEM_SMS_CAMPAIGN_v4 d on
a.customer_key=d.customer_key and lower(a.campaign_desc)=lower(d.can)
left join LS_SFMC_SMS_OPT_OUT g on
a.customer_key = g.customer_key and lower(a.campaign_desc) = lower(g.campaign_name)
                
left outer join 
SMS_Undelivered_main b on 
a.customer_key=b.customer_id 
       and upper(a.campaign_desc)=upper(b.campaign_desc)
       )
 
     SELECT * FROM campaign_wise_sms_communications_main;
     
CREATE or replace TABLE AM_BIRD_campaign_wise_sms_communications_main_FINAL_Test as

SELECT 
    CUSTOMER_KEY, 
    COUNTRY, 
    RELEASE_2_VENDOR_DATE, 
    ACTIVITY_CODE, 
    CAMPAIGN_DESC, 
    CAMPAIGN_DESC_1, 
    PREV_EVENT_CAPTURED_DT, 
    DAYS_BETWEEN_COMMUNICATION, 
    DELIVERY_FLAG, 
    RESEND_FLAG, 
    CLICK_FLAG, 
    OFFER_URL,
    MODE(sms_clicked_in_30_Days) AS sms_clicked_in_30_Days,
    --case when DELIVERY_FLAG='UNDELIVERED' then 1 else 0 end EMAILS_UN_DELIVERED,
    --case when optout_date is not null then 1 else 0 end CUSTOMERS_OPTING_OUT_OF_EMAIL_MARKETING,
    COUNT(DISTINCT CUSTOMER_KEY) AS COMMUNICATIONS_SENT,
    COUNT(DISTINCT CASE WHEN SMS_CLICKED_IN_7_DAYS = 'Y' THEN CUSTOMER_KEY END) AS CLICK_COUNT,
    MIN(CASE WHEN CLICK_DATE >= RELEASE_2_VENDOR_DATE THEN CLICK_DATE END) AS CLICK_DATE, 
    MIN(CASE WHEN OPTOUT_DATE >= RELEASE_2_VENDOR_DATE THEN OPTOUT_DATE END) AS OPTOUT_DATE    
FROM AM_BIRD_campaign_wise_sms_communications_TEST

GROUP BY ALL;

in this i have to incorporate another CTE after LS_sfmc_CEM_SMS_CAMPAIGN_v4 since there's a new table created from which now click 
data will come , so i have to add that after LS_sfmc_CEM_SMS_CAMPAIGN_v4 and then union both the CTEs into a final one and that CTE 
will be in the join and make it flow to the next table accordingly.
The new table is WUDNA.SUMMARY_GEN.BIRD_WU_MARKETING_SMS_CLICK_VW
and the columns are 
name
CAMPAIGN_ID
CAMPAIGN_NAME
CHANNEL_ID
CUSTOMER_KEY
EVENT_DATETIME --IS CLICK_DATE
EVENT_ID
EVENT_NAME
JOURNEY_ID
JOURNEY_NAME
MESSAGE_ID
MOBILE_PHONE_NUMBER
TEMPLATE_NAME
URL
BATCH_DATE .

So create an updated script accordingly. 
